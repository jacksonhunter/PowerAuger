# PURPOSE: Ultra-fast, deterministic PowerShell code completion.
FROM qwen3:4b-q4_K_M

# TUNING: Optimized for speed and predictability.
PARAMETER temperature 0.1
PARAMETER top_k 30
PARAMETER top_p 0.8
PARAMETER num_ctx 2048
PARAMETER num_predict 80
PARAMETER repeat_penalty 1.05

# STOP TOKENS: Native model stops + task-specific stops.
PARAMETER stop "<|im_end|>"
PARAMETER stop "<|im_start|>"
PARAMETER stop "User:"
PARAMETER stop "Assistant:"
PARAMETER stop "PS>"

TEMPLATE """{{ if .System }}{{ .System }}{{ end }}
INPUT: {{ .Prompt }}
OUTPUT:{{ .Response }}"""

SYSTEM """You are a PowerShell completion engine.
RULES:
1. Provide 3-7 likely command completions.
2. Each completion is on a new line.
3. Output ONLY the commands. No explanations, no markdown.
4. Prioritize common cmdlets, parameters, and paths."""

MESSAGE user Get-Child
MESSAGE assistant """Get-ChildItem
Get-ChildItem -Path
Get-ChildItem -Recurse
Get-ChildItem -Filter"""

MESSAGE user git st
MESSAGE assistant """git status
git status --short
git stash"""